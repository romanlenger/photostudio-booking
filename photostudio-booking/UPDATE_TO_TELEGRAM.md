# üöÄ –û–ù–û–í–õ–ï–ù–ù–Ø: TELEGRAM –ü–Ü–î–¢–í–ï–†–î–ñ–ï–ù–ù–Ø –ë–†–û–ù–Æ–í–ê–ù–¨

## ‚úÖ –©–û –î–û–î–ê–ù–û:

### 1. Telegram Bot –∑ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è–º
- –ö–ª—ñ—î–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∑ —Å–∞–π—Ç—É –≤ Telegram
- –ë–æ—Ç –ø–æ–∫–∞–∑—É—î –ø—Ä–∞–≤–∏–ª–∞ —Å—Ç—É–¥—ñ—ó
- –ö–Ω–æ–ø–∫–∏: –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ / –°–∫–∞—Å—É–≤–∞—Ç–∏
- –ü—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è - —Ä–µ–∫–≤—ñ–∑–∏—Ç–∏ –¥–ª—è –æ–ø–ª–∞—Ç–∏
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —Å–∫—Ä—ñ–Ω—à–æ—Ç –æ–ø–ª–∞—Ç–∏

### 2. –°—Ç–∞—Ç—É—Å–∏ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è
- `pending` - —Å—Ç–≤–æ—Ä–µ–Ω–æ, –æ—á—ñ–∫—É—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
- `confirmed` - –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ, –æ—á—ñ–∫—É—î –æ–ø–ª–∞—Ç—É
- `paid` - –æ–ø–ª–∞—á–µ–Ω–æ
- `cancelled` - —Å–∫–∞—Å–æ–≤–∞–Ω–æ

### 3. –ê–¥–∞–ø—Ç–∏–≤–Ω–∏–π –¥–∏–∑–∞–π–Ω
- –ü–æ–≤–Ω—ñ—Å—Ç—é –∞–¥–∞–ø—Ç–∏–≤–Ω–∏–π –¥–ª—è Mobile / Tablet / Desktop
- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ø–æ–≤–µ—Ä—Ö header
- Calendar-header –ø—ñ–¥–Ω—è—Ç–æ –≤–∏—â–µ –Ω–∞ –º–æ–±—ñ–ª—å–Ω–∏—Ö

---

## üìã –Ü–ù–°–¢–†–£–ö–¶–Ü–Ø –ó –û–ù–û–í–õ–ï–ù–ù–Ø:

### –ö–†–û–ö 1: –°—Ç–≤–æ—Ä–∏—Ç–∏ Telegram –±–æ—Ç–∞

1. –í—ñ–¥–∫—Ä–∏–π [@BotFather](https://t.me/BotFather)
2. –ù–∞–¥—ñ—à–ª–∏ `/newbot`
3. –ù–∞–∑–≤–∞: "CLIQUE Booking"
4. Username: –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `clique_booking_bot`
5. –ó–±–µ—Ä–µ–∂–∏ **TOKEN** —Ç–∞ **USERNAME**

---

### –ö–†–û–ö 2: –î—ñ–∑–Ω–∞—Ç–∏—Å—è Telegram ID

1. –í—ñ–¥–∫—Ä–∏–π [@userinfobot](https://t.me/userinfobot)
2. –ù–∞–¥—ñ—à–ª–∏ `/start`
3. –ó–±–µ—Ä–µ–∂–∏ —Å–≤—ñ–π ID (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `453977317`)

---

### –ö–†–û–ö 3: –û–Ω–æ–≤–∏—Ç–∏ .env —Ñ–∞–π–ª

–í—ñ–¥–∫—Ä–∏–π `.env` —ñ –¥–æ–¥–∞–π/–æ–Ω–æ–≤–∏–ë–û–¢_USERNAME:

```bash
# Telegram Bot
BOT_TOKEN=—Ç–≤—ñ–π_—Ç–æ–∫–µ–Ω_–≤—ñ–¥_BotFather
BOT_USERNAME=—Ç–≤—ñ–π_username_–±–µ–∑_@
ADMIN_IDS=453977317,658377272

# –ü—Ä–∞–≤–∏–ª–∞ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
STUDIO_RULES=üìã –ü—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ç–æ—Å—Ç—É–¥—ñ—ó CLIQUE:\n\n1. –ü—Ä–∏—Ö–æ–¥—å—Ç–µ –≤—á–∞—Å–Ω–æ\n2. ...

# –†–µ–∫–≤—ñ–∑–∏—Ç–∏ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
PAYMENT_DETAILS=üí≥ –ö–∞—Ä—Ç–∫–∞: 1234 5678 9012 3456\n...
```

**–í–ê–ñ–õ–ò–í–û:**
- `BOT_TOKEN` - –∑ BotFather
- `BOT_USERNAME` - –ë–ï–ó —Å–∏–º–≤–æ–ª—É @
- `ADMIN_IDS` - —Ç–≤–æ—ó Telegram ID —á–µ—Ä–µ–∑ –∫–æ–º—É

---

### –ö–†–û–ö 4: –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é –ë–î

```bash
# –ü—ñ–¥–∫–ª—é—á–∏—Å—å –¥–æ PostgreSQL
docker exec -it photostudio-booking-db-1 psql -U photostudio -d photostudio_db

# –í–∏–∫–æ–Ω–∞–π –º—ñ–≥—Ä–∞—Ü—ñ—é
\i /migrations/002_add_telegram_support.sql

# –ü–µ—Ä–µ–≤—ñ—Ä
\d bookings

# –í–∏–π–¥–∏
\q
```

–ê–±–æ –≤—Ä—É—á–Ω—É:

```sql
ALTER TABLE bookings ADD COLUMN status VARCHAR(20) DEFAULT 'pending';
ALTER TABLE bookings ADD COLUMN telegram_user_id BIGINT;
ALTER TABLE bookings ADD COLUMN confirmation_message_id BIGINT;
UPDATE bookings SET status = 'confirmed' WHERE status IS NULL;
```

---

### –ö–†–û–ö 5: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ Docker

```bash
cd ~/photostudio-booking

# –ó—É–ø–∏–Ω–∏—Ç–∏
docker-compose down

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç–∏
docker-compose build

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏
docker-compose up -d

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏
docker-compose logs -f
```

---

## ‚úÖ –ü–ï–†–ï–í–Ü–†–ö–ê:

### 1. –ü–µ—Ä–µ–≤—ñ—Ä –≤–µ–±-—Å–∞–π—Ç:
```
http://192.168.88.26:8000
```

### 2. –ü–µ—Ä–µ–≤—ñ—Ä –±–æ—Ç–∞:
```
1. –ó–Ω–∞–π–¥–∏ –±–æ—Ç–∞: @—Ç–≤—ñ–π_username
2. –ù–∞–¥—ñ—à–ª–∏ /start
3. –ú–∞—î—à –ø–æ–±–∞—á–∏—Ç–∏: "–í—ñ—Ç–∞—é, –∞–¥–º—ñ–Ω–µ!"
```

### 3. –¢–µ—Å—Ç–æ–≤–µ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è:
```
1. –°–∞–π—Ç ‚Üí –í–∏–±–µ—Ä–∏ –¥–∞—Ç—É/—á–∞—Å
2. –ó–∞–ø–æ–≤–Ω–∏ —Ñ–æ—Ä–º—É ‚Üí "–ó–∞–±—Ä–æ–Ω—é–≤–∞—Ç–∏"
3. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤ Telegram ‚Üí –ë–æ—Ç –ø–æ–∫–∞–∑—É—î –ø—Ä–∞–≤–∏–ª–∞
4. –ù–∞—Ç–∏—Å–Ω–∏ "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏" ‚Üí –ë–∞—á–∏—à —Ä–µ–∫–≤—ñ–∑–∏—Ç–∏
```

---

## üéØ FLOW –ë–†–û–ù–Æ–í–ê–ù–ù–Ø:

```
–ö–õ–Ü–Ñ–ù–¢:
1. –°–∞–π—Ç ‚Üí –§–æ—Ä–º–∞ ‚Üí "–ó–∞–±—Ä–æ–Ω—é–≤–∞—Ç–∏"
2. –ë—Ä–æ–Ω—å —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è (status: pending)
3. –ü–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü—ñ—è –≤ Telegram
4. –ë–æ—Ç ‚Üí –ü—Ä–∞–≤–∏–ª–∞ + –∫–Ω–æ–ø–∫–∏
5. "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏" ‚Üí status: confirmed
6. –û—Ç—Ä–∏–º—É—î —Ä–µ–∫–≤—ñ–∑–∏—Ç–∏
7. –ü–ª–∞—Ç–∏—Ç—å ‚Üí –ù–∞–¥—Å–∏–ª–∞—î —Å–∫—Ä—ñ–Ω—à–æ—Ç
8. status: paid

–ê–î–ú–Ü–ù:
1. –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è: "–ù–æ–≤–µ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è"
2. –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è: "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ"
3. –û—Ç—Ä–∏–º—É—î —Å–∫—Ä—ñ–Ω—à–æ—Ç
4. –ü–µ—Ä–µ–≤—ñ—Ä—è—î –æ–ø–ª–∞—Ç—É
```

---

## üîß –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø:

### –ó–º—ñ–Ω–∏—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞:

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π `.env`:

```bash
STUDIO_RULES=üìã –ù–æ–≤—ñ –ø—Ä–∞–≤–∏–ª–∞:\n\n1. ...\n2. ...
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞:
```bash
docker-compose restart bot
```

### –ó–º—ñ–Ω–∏—Ç–∏ —Ä–µ–∫–≤—ñ–∑–∏—Ç–∏:

```bash
PAYMENT_DETAILS=üí≥ –ù–æ–≤–∞ –∫–∞—Ä—Ç–∫–∞: ...\n...
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏:
```bash
docker-compose restart bot
```

---

## üêõ TROUBLESHOOTING:

### –ë–æ—Ç –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î:
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä –ª–æ–≥–∏
docker-compose logs bot

# –ü–µ—Ä–µ–≤—ñ—Ä —Ç–æ–∫–µ–Ω
cat .env | grep BOT_TOKEN
```

### –ù–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤ Telegram:
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä BOT_USERNAME (–±–µ–∑ @)
cat .env | grep BOT_USERNAME
```

### –ê–¥–º—ñ–Ω –Ω–µ –æ—Ç—Ä–∏–º—É—î —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è:
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä ADMIN_IDS
cat .env | grep ADMIN_IDS
```

### –ë–∞–∑–∞ –Ω–µ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è:
```bash
# –í–∏–∫–æ–Ω–∞–π –º—ñ–≥—Ä–∞—Ü—ñ—é –≤—Ä—É—á–Ω—É
docker exec -it photostudio-booking-db-1 psql -U photostudio -d photostudio_db

ALTER TABLE bookings ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending';
ALTER TABLE bookings ADD COLUMN IF NOT EXISTS telegram_user_id BIGINT;
ALTER TABLE bookings ADD COLUMN IF NOT EXISTS confirmation_message_id BIGINT;
```

---

## üìä –ù–û–í–Ü –§–ê–ô–õ–ò:

```
photostudio-booking/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ models.py          ‚Üê –°–¢–í–û–†–ï–ù–û (–∑ –ø–æ–ª—è–º–∏ status, telegram_*)
‚îÇ   ‚îú‚îÄ‚îÄ database.py        ‚Üê –°–¢–í–û–†–ï–ù–û
‚îÇ   ‚îú‚îÄ‚îÄ main.py            ‚Üê –û–ù–û–í–õ–ï–ù–û (–ø–æ–≤–µ—Ä—Ç–∞—î telegram_link)
‚îÇ   ‚îî‚îÄ‚îÄ schemas.py         ‚Üê –û–ù–û–í–õ–ï–ù–û (–¥–æ–¥–∞–Ω–æ telegram_link)
‚îú‚îÄ‚îÄ bot.py                 ‚Üê –°–¢–í–û–†–ï–ù–û (Telegram –±–æ—Ç)
‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îú‚îÄ‚îÄ index.html         ‚Üê –û–ù–û–í–õ–ï–ù–û (–∞–¥–∞–ø—Ç–∏–≤ + –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü—ñ—è)
‚îÇ   ‚îî‚îÄ‚îÄ admin.html         ‚Üê –û–ù–û–í–õ–ï–ù–û (–∞–¥–∞–ø—Ç–∏–≤)
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îî‚îÄ‚îÄ 002_add_telegram_support.sql ‚Üê –°–¢–í–û–†–ï–ù–û
‚îú‚îÄ‚îÄ docker-compose.yml     ‚Üê –û–ù–û–í–õ–ï–ù–û (–¥–æ–¥–∞–Ω–æ bot service)
‚îú‚îÄ‚îÄ Dockerfile             ‚Üê –°–¢–í–û–†–ï–ù–û
‚îú‚îÄ‚îÄ requirements.txt       ‚Üê –û–ù–û–í–õ–ï–ù–û (–¥–æ–¥–∞–Ω–æ pyTelegramBotAPI)
‚îî‚îÄ‚îÄ .env                   ‚Üê –û–ù–û–í–õ–ï–ù–û (–¥–æ–¥–∞–Ω–æ BOT_TOKEN, BOT_USERNAME, etc)
```

---

## üîê –ë–ï–ó–ü–ï–ö–ê:

1. ‚úÖ –ù–µ –ø–æ–∫–∞–∑—É–π .env —Ñ–∞–π–ª
2. ‚úÖ ADMIN_IDS - —Ç—ñ–ª—å–∫–∏ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω—ñ –ª—é–¥–∏
3. ‚úÖ BOT_TOKEN - —Ç—Ä–∏–º–∞–π –≤ —Å–µ–∫—Ä–µ—Ç—ñ
4. ‚úÖ Backup –ë–î: `docker exec ... pg_dump ...`

---

## üí° –ú–ê–ô–ë–£–¢–ù–Ü –ü–û–ö–†–ê–©–ï–ù–ù–Ø:

- [ ] –û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞ (LiqPay, WayForPay)
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è –Ω–µ–æ–ø–ª–∞—á–µ–Ω–∏—Ö (—á–µ—Ä–µ–∑ 24 –≥–æ–¥)
- [ ] –ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è –ø—Ä–æ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è
- [ ] –í—ñ–¥–≥—É–∫–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤

---

**–í–°–ï –ì–û–¢–û–í–û! –ó–ê–ü–£–°–ö–ê–ô! üöÄ‚ú®**
